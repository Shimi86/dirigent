<?xml version="1.0" encoding="UTF-8"?>
<Shared>
    <!-- Free apps (app defaults if an app is not part of any plan, having own app definition -->
	<App AppIdTuple = "m1.a" Template = "apps.notepad" Groups="Folder Free"/>

    <!-- Plans -->
    <Plan Name="plan1" StartTimeout="10" Groups="Test1">
    	<App
    	    AppIdTuple = "m1.a"
    		Template = "apps.notepad"
    		ExeFullPath = "%SystemRoot%\notepad.exe"
    		StartupDir = "%USERPROFILE%\Documents"
    		CmdLineArgs = "aaa.txt"
    		XXX_InitCondition = "exitcode 0"
    		Groups="Folder 1"
    		MinKillingTime = "3.5"
    	    >
    		<WindowPos titleregexp="\s-\sNotepad" rect="10,50,300,200" screen="1" keep="0" />

            <File Id="aaa" Path="%USERPROFILE%\Documents\aaa.txt"/>

    	</App>

    	<App
    	    AppIdTuple = "m1.b"
    		Template = "apps.notepad"
    		StartupDir = "c:\"
    		CmdLineArgs = "bbb.txt"
    		Dependencies = "m1.a;"
    	/>

    	<App
    	    AppIdTuple = "m2.c"
    		Template = "apps.notepad"
    		ExeFullPath = "c:\windows\notepad.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = "ccc.txt"
    	/>

    	<App
    	    AppIdTuple = "m1.d"
    		Template = "apps.cmd.show_vars"
    		Volatile = "1"
    		>
    		<Env>
    		  <!-- Generic environment variable handling-->
    		  <Set Variable="TMP" Value="X:\TEMP" />
    		  <Set Variable="EXPANSION_TEST" Value="xxx%USERNAME%xxx" />
    		  <!-- specific support for Path variable modifications-->
    		  <Path Prepend="C:\BIN;%ProgramFiles%\MyApp\Bin;RelPath1\sub1;..\RelPath2\sub1" /> 
    		</Env>
    	</App>

    	<App
    	    AppIdTuple = "m1.ShowEnvVars"
    		Template = "apps.cmd.show_vars"
    		ReusePrevVars = "1"
    		LeaveRunningWithPrevVars = "1"
    		>
    	</App>

    	<App
    	    AppIdTuple = "m3.bash"
    		ExeFullPath = "/usr/bin/bash"
    		StartupDir = "%HOME%"
    		CmdLineArgs = "a.sh"
    		Volatile = "1"
    		>
    	</App>

    	<App
    	    AppIdTuple = "m3.id"
    		ExeFullPath = "/usr/bin/id"
    		CmdLineArgs = ""
    		StartupDir = "%HOME%"
    		Volatile = "1"
    		>
    	</App>
    </Plan>

    <Plan Name="plan2"  Groups="Test1" ApplyOnSelect="1">
    	<App
    	    AppIdTuple = "m1.b"
    		Template = "apps.notepad"
    		ExeFullPath = "c:\windows\notepad.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = "bbb.txt"
    		RestartOnCrash = "0"
    		Volatile = "1"
    		InitCondition = "exitcode 0"
    		Dependencies = "m1.a"
    	/>
    </Plan>

    <Plan Name="plan3">
    	<App
    	    AppIdTuple = "m2.c"
    		Template = "apps.notepad"
    		ExeFullPath = "c:\windows\notepad.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = "CCCx.txt"
    		InitCondition = "exitcode 0"
    	/>
    </Plan>

    <Plan Name="planX"  Groups="Test2">
    	<App
    	    AppIdTuple = "m1.x"
    		Template = "apps.notepad"
    		ExeFullPath = "c:\windows\notepad.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = "xxx.txt"
    		InitCondition = "exitcode 0"
    	/>
    </Plan>

    <Plan Name="empty">
    </Plan>


    <Script Name="Demo1" File="Scripts/DemoScript1.cs" Args="" Groups="Examples;;Common/Demo"/>

    <AppTemplate Name="apps.notepad"
    		Template = ""
    		ExeFullPath = "c:\windows\notepad.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = ""
    		StartupOrder = "0"
    		RestartOnCrash = "1"
    		InitCondition = "timeout 2.0"
    		SeparationInterval = "0.5"
    		Groups="Folder 2"
    />

    <AppTemplate Name="apps.cmd"
    		Template = ""
    		ExeFullPath = "c:\windows\system32\cmd.exe"
    		StartupDir = "c:\"
    		CmdLineArgs = ""
    		StartupOrder = "0"
    		RestartOnCrash = "0"
    		InitCondition = "timeout 2.0"
    		SeparationInterval = "0.5"
    		KillTree = "1"
    		WindowStyle = "normal"
    />

    <AppTemplate Name="apps.bash"
    		Template = ""
    		ExeFullPath = "/usr/bin/bash"
    		StartupDir = ""
    		CmdLineArgs = ""
    />

    <AppTemplate Name="apps.cmd.show_vars"
    		Template = "apps.cmd"
    		StartupDir = "c:\"
    		CmdLineArgs = "/c &quot;set&amp;&amp;pause&quot;"
    />

    <Machine Name="m1">
        <Share Name="C" Path="C:\"/>
        <Share Name="D$" Path="d:\"/>
        <File Id="Greetings" Path="%USERPROFILE%\Documents\Greetings.txt"/>
        <NewestFile Id="Log" Folder="C:\Logs\App1" Mask="*.txt" Recursive="1"/>
        <Folder Id="Docs" Path="%USERPROFILE%\Documents"/>

        <!-- Tasks are shown in machine's context menu.
             They are actually scripts running partly on the target machine and partly on the client
             they were invoked from. -->
        <Task Id="task1" Title="Machine specific task" Script="MachineScripts/Test1" Args=""/>

        <!-- Tools are added to machine's Tools menu. Tools are always started on local machine.
            Tools are defined in LocalConfig.xml file. -->
		<Tool Id="VncViewer" Title="VNC to m1" CmdLineArgs="%MACHINE_IP%"/>

		<!-- Network services available on the machine.
    		 In case of connecting via SSH dirigent sets up the port forwarding for these. -->
		<Service Name="VNC" Port="5900"/>


     </Machine>

   	<App
	    AppIdTuple = "m1.appWithFile"
		Template = "apps.notepad"
		ExeFullPath = "%SystemRoot%\notepad.exe"
		StartupDir = "%USERPROFILE%\Documents"
		CmdLineArgs = "xxx.txt"
	    >

        <File Id="xxx" Path="%USERPROFILE%\Documents\xxx.txt"/>
        <Folder Id="LocalData" Path="%AppData%\Local\AppWithFile"/>
        <!-- task to be shown in the app's context menu !-->
        <Task Id="task1" Title="App-specific task nice name" Script="AppScripts/Test1" Args=""/>

        <Tool Id="Notepad" Title="Open some file in Notepad" CmdLineArgs="somefile.txt"/>
	</App>

	<FilePackage Name="pack1">
	    <!-- reference to machine-specific file-->
	    <FileRef Machine="m1" Id="Greetings"/>
	    <!-- reference to application-specific file-->
	    <FileRef AppIdTuple = "m1.appWithFile" Id="xxx"/>
	    <!-- direct definition of independent file using UNC path-->

        <Task Id="task1" Title="FilePackage-specific task nice name" Script="PackageScripts/Test1" Args=""/>

	    <Tool Id="FileCmd" Title="Browse files in package" CmdLineArgs="%FILEPACKAGE_LIST_FILE%"/>
    </FilePackage>


	<!-- global files specification -->
	<File Id="global4" Path="\\server\share\path\to\file.txt">
	    <!-- Tasks appear in the file's context menu -->
        <Task Id="task1" Title="File-specific task nice name" Script="FileScripts/Test1" Args=""/>
        <!-- Tools appear in the file's context menu -->
        <Tool Id="Notepad" Title="Notepad++"/>
	</File>

	<File Id="local1" MachineId="m1" Path="D:\TEMP\file.txt">
        <!-- Tools appear in the file's context menu -->
        <Tool Id="Notepad" Title="Notepad++"/>
	</File>

	<!-- This is a default item which does not need to be defined explicitly unless you need some special tools for it;
	     the path is provided automatically -->
	<File Id="DirigentSharedConfig" Title="SharedConfig">
        <Tool Id="Notepad" Title="Notepad++" CmdLineArgs="%FILE_PATH%"/>
	</File>

	<!-- Gateway network settings for tunelling network service ports in case we connect via SSH.
         This actually makes no sense here as the shared config is not available until connected.
         It might be read by not yet connected Dirigent if the shared config
	<SshGateway
		ExternalIP = "10.0.102.5"
		InternalIP =  "192.168.0.150"
		Port = "22"
		UserName = "user"
		Password = "password"
	/> --> 



</Shared>
